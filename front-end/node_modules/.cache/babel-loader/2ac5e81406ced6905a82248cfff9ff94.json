{"ast":null,"code":"/**\r\n * DevExtreme (esm/ui/lookup.js)\r\n * Version: 21.2.4\r\n * Build date: Mon Dec 06 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport { getWidth, getHeight, getOuterHeight, getOuterWidth } from \"../core/utils/size\";\nimport $ from \"../core/renderer\";\nimport eventsEngine from \"../events/core/events_engine\";\nimport { getWindow } from \"../core/utils/window\";\nvar window = getWindow();\nimport { nativeScrolling } from \"../core/utils/support\";\nimport { noop } from \"../core/utils/common\";\nimport { getPublicElement } from \"../core/element\";\nimport { each } from \"../core/utils/iterator\";\nimport { extend } from \"../core/utils/extend\";\nimport { getFieldName } from \"../core/options/utils\";\nimport messageLocalization from \"../localization/message\";\nimport devices from \"../core/devices\";\nimport registerComponent from \"../core/component_registrator\";\nimport { addNamespace } from \"../events/utils/index\";\nimport DropDownList from \"./drop_down_editor/ui.drop_down_list\";\nimport { current, isMaterial } from \"./themes\";\nimport { name as clickEventName } from \"../events/click\";\nimport Popover from \"./popover\";\nimport TextBox from \"./text_box\";\nimport { ChildDefaultTemplate } from \"../core/templates/child_default_template\";\nimport { locate, move, resetPosition } from \"../animation/translator\";\nimport { isDefined } from \"../core/utils/type\";\nimport { getElementWidth } from \"./drop_down_editor/utils\";\nvar LOOKUP_CLASS = \"dx-lookup\";\nvar LOOKUP_SEARCH_CLASS = \"dx-lookup-search\";\nvar LOOKUP_SEARCH_WRAPPER_CLASS = \"dx-lookup-search-wrapper\";\nvar LOOKUP_FIELD_CLASS = \"dx-lookup-field\";\nvar LOOKUP_ARROW_CLASS = \"dx-lookup-arrow\";\nvar LOOKUP_FIELD_WRAPPER_CLASS = \"dx-lookup-field-wrapper\";\nvar LOOKUP_POPUP_CLASS = \"dx-lookup-popup\";\nvar LOOKUP_POPUP_WRAPPER_CLASS = \"dx-lookup-popup-wrapper\";\nvar LOOKUP_POPUP_SEARCH_CLASS = \"dx-lookup-popup-search\";\nvar LOOKUP_POPOVER_MODE = \"dx-lookup-popover-mode\";\nvar LOOKUP_EMPTY_CLASS = \"dx-lookup-empty\";\nvar LOOKUP_POPOVER_FLIP_VERTICAL_CLASS = \"dx-popover-flipped-vertical\";\nvar TEXTEDITOR_INPUT_CLASS = \"dx-texteditor-input\";\nvar LIST_ITEM_CLASS = \"dx-list-item\";\nvar LIST_ITEM_SELECTED_CLASS = \"dx-list-item-selected\";\nvar GROUP_LIST_HEADER_CLASS = \"dx-list-group-header\";\nvar MATERIAL_LOOKUP_LIST_ITEMS_COUNT = 5;\nvar MATERIAL_LOOKUP_LIST_PADDING = 8;\nvar Lookup = DropDownList.inherit({\n  _supportedKeys: function () {\n    return extend(this.callBase(), {\n      space: function (e) {\n        e.preventDefault();\n\n        this._validatedOpening();\n      },\n      enter: function () {\n        this._validatedOpening();\n      }\n    });\n  },\n  _getDefaultOptions: function () {\n    return extend(this.callBase(), {\n      placeholder: messageLocalization.format(\"Select\"),\n      searchPlaceholder: messageLocalization.format(\"Search\"),\n      searchEnabled: true,\n      cleanSearchOnOpening: true,\n      showCancelButton: true,\n      showClearButton: false,\n      clearButtonText: messageLocalization.format(\"Clear\"),\n      applyButtonText: messageLocalization.format(\"OK\"),\n      pullRefreshEnabled: false,\n      useNativeScrolling: true,\n      pullingDownText: messageLocalization.format(\"dxList-pullingDownText\"),\n      pulledDownText: messageLocalization.format(\"dxList-pulledDownText\"),\n      refreshingText: messageLocalization.format(\"dxList-refreshingText\"),\n      pageLoadingText: messageLocalization.format(\"dxList-pageLoadingText\"),\n      onScroll: null,\n      onPullRefresh: null,\n      onPageLoading: null,\n      pageLoadMode: \"scrollBottom\",\n      nextButtonText: messageLocalization.format(\"dxList-nextButtonText\"),\n      grouped: false,\n      groupTemplate: \"group\",\n      usePopover: false,\n      showDropDownButton: false,\n      focusStateEnabled: false,\n      dropDownOptions: {\n        showTitle: true,\n        width: function () {\n          return .8 * getWidth(window);\n        },\n        height: function () {\n          return .8 * getHeight(window);\n        },\n        shading: true,\n        closeOnOutsideClick: false,\n        position: void 0,\n        animation: {},\n        title: \"\",\n        titleTemplate: \"title\",\n        onTitleRendered: null,\n        fullScreen: false\n      },\n      dropDownCentered: false,\n      _scrollToSelectedItemEnabled: false,\n      useHiddenSubmitElement: true\n    });\n  },\n  _defaultOptionsRules: function () {\n    var themeName = current();\n    return this.callBase().concat([{\n      device: function () {\n        return !nativeScrolling;\n      },\n      options: {\n        useNativeScrolling: false\n      }\n    }, {\n      device: function (_device) {\n        return !devices.isSimulator() && \"desktop\" === devices.real().deviceType && \"generic\" === _device.platform;\n      },\n      options: {\n        usePopover: true,\n        dropDownOptions: {\n          height: \"auto\"\n        }\n      }\n    }, {\n      device: {\n        platform: \"ios\",\n        phone: true\n      },\n      options: {\n        dropDownOptions: {\n          fullScreen: true\n        }\n      }\n    }, {\n      device: {\n        platform: \"ios\",\n        tablet: true\n      },\n      options: {\n        dropDownOptions: {\n          width: function () {\n            return .4 * Math.min(getWidth(window), getHeight(window));\n          },\n          height: \"auto\"\n        },\n        usePopover: true\n      }\n    }, {\n      device: function () {\n        return \"desktop\" === devices.real().deviceType && !devices.isSimulator();\n      },\n      options: {\n        focusStateEnabled: true\n      }\n    }, {\n      device: function () {\n        return isMaterial(themeName);\n      },\n      options: {\n        usePopover: false,\n        searchEnabled: false,\n        showCancelButton: false,\n        dropDownCentered: true,\n        _scrollToSelectedItemEnabled: true,\n        dropDownOptions: {\n          closeOnOutsideClick: true,\n          _ignoreFunctionValueDeprecation: true,\n          width: () => getElementWidth(this.$element()),\n          height: function () {\n            return this._getPopupHeight();\n          }.bind(this),\n          showTitle: false,\n          shading: false\n        }\n      }\n    }]);\n  },\n  _init: function () {\n    this.callBase();\n\n    this._initActions();\n  },\n\n  _initActions() {\n    this.callBase();\n\n    this._initScrollAction();\n\n    this._initPageLoadingAction();\n\n    this._initPullRefreshAction();\n  },\n\n  _initPageLoadingAction: function () {\n    this._pageLoadingAction = this._createActionByOption(\"onPageLoading\");\n  },\n  _initPullRefreshAction: function () {\n    this._pullRefreshAction = this._createActionByOption(\"onPullRefresh\");\n  },\n  _initScrollAction: function () {\n    this._scrollAction = this._createActionByOption(\"onScroll\");\n  },\n  _scrollHandler: function (e) {\n    this._scrollAction(e);\n  },\n  _pullRefreshHandler: function (e) {\n    this._pullRefreshAction(e);\n  },\n  _pageLoadingHandler: function (e) {\n    this._pageLoadingAction(e);\n  },\n  _initTemplates: function () {\n    this.callBase();\n\n    this._templateManager.addDefaultTemplates({\n      group: new ChildDefaultTemplate(\"group\"),\n      title: new ChildDefaultTemplate(\"title\")\n    });\n  },\n  _initMarkup: function () {\n    this.$element().addClass(LOOKUP_CLASS).toggleClass(LOOKUP_POPOVER_MODE, this.option(\"usePopover\"));\n    this.callBase();\n  },\n  _inputWrapper: function () {\n    return this.$element().find(\".\" + LOOKUP_FIELD_WRAPPER_CLASS);\n  },\n  _dataSourceOptions: function () {\n    return extend(this.callBase(), {\n      paginate: true\n    });\n  },\n  _fireContentReadyAction: noop,\n  _popupWrapperClass: function () {\n    return \"\";\n  },\n  _renderInput: function () {\n    var fieldClickAction = this._createAction(() => {\n      this._toggleOpenState();\n    });\n\n    this._$field = $(\"<div>\").addClass(LOOKUP_FIELD_CLASS);\n    eventsEngine.on(this._$field, addNamespace(clickEventName, this.NAME), e => {\n      fieldClickAction({\n        event: e\n      });\n    });\n    var $arrow = $(\"<div>\").addClass(LOOKUP_ARROW_CLASS);\n    this._$fieldWrapper = $(\"<div>\").addClass(LOOKUP_FIELD_WRAPPER_CLASS).append(this._$field).append($arrow).appendTo(this.$element());\n  },\n\n  _getInputContainer() {\n    return this._$fieldWrapper;\n  },\n\n  _renderField: function () {\n    var fieldTemplate = this._getTemplateByOption(\"fieldTemplate\");\n\n    if (fieldTemplate && this.option(\"fieldTemplate\")) {\n      this._renderFieldTemplate(fieldTemplate);\n\n      return;\n    }\n\n    var displayValue = this.option(\"displayValue\");\n\n    this._updateField(isDefined(displayValue) && String(displayValue) || this.option(\"placeholder\"));\n\n    this.$element().toggleClass(LOOKUP_EMPTY_CLASS, !this.option(\"selectedItem\"));\n  },\n  _getLabelContainer: function () {\n    return this._$field;\n  },\n  _renderDisplayText: function (text) {\n    if (this._input().length) {\n      this.callBase(text);\n    } else {\n      this._updateField(text);\n    }\n  },\n  _updateField: function (text) {\n    this._$field.text(text);\n  },\n  _renderFieldTemplate: function (template) {\n    this._$field.empty();\n\n    var data = this._fieldRenderData();\n\n    template.render({\n      model: data,\n      container: getPublicElement(this._$field)\n    });\n  },\n  _fieldRenderData: function () {\n    return this.option(\"selectedItem\");\n  },\n  _popupShowingHandler: function () {\n    this.callBase.apply(this, arguments);\n\n    if (this.option(\"cleanSearchOnOpening\")) {\n      if (this.option(\"searchEnabled\") && this._searchBox.option(\"value\")) {\n        this._searchBox.option(\"value\", \"\");\n\n        this._searchCanceled();\n      }\n\n      this._list && this._list.option(\"focusedElement\", null);\n    }\n\n    if (this.option(\"dropDownOptions.fullScreen\") && this.option(\"_scrollToSelectedItemEnabled\")) {\n      this._popup.option(\"position\").of = $(window);\n    }\n  },\n  _popupShownHandler: function () {\n    var scrollToSelectedItemEnabled = this.option(\"_scrollToSelectedItemEnabled\");\n    var fullScreen = this.option(\"dropDownOptions.fullScreen\");\n\n    if (!fullScreen && scrollToSelectedItemEnabled) {\n      this._setPopupPosition();\n    }\n\n    this.callBase();\n  },\n  _scrollToSelectedItem: function () {\n    var selectedIndex = this._list.option(\"selectedIndex\");\n\n    var listItems = this._list.option(\"items\");\n\n    var itemsCount = listItems.length;\n\n    if (0 !== itemsCount) {\n      if (this._list.option(\"grouped\")) {\n        this._list.scrollToItem({\n          group: itemsCount - 1,\n          item: listItems[itemsCount - 1].items.length - 1\n        });\n      } else {\n        this._list.scrollToItem(itemsCount - 1);\n      }\n\n      this._list.scrollToItem(selectedIndex);\n    }\n  },\n  _getDifferenceOffsets: function (selectedListItem) {\n    return selectedListItem.offset().top - $(this.element()).offset().top;\n  },\n  _isCenteringEnabled: (index, count) => 1 < index && index < count - 2,\n  _getPopupOffset: function () {\n    var listItemsCount = this._listItemElements().length;\n\n    if (0 === listItemsCount) {\n      return;\n    }\n\n    var selectedListItem = $(this._list.element()).find(\".\" + LIST_ITEM_SELECTED_CLASS);\n\n    var selectedIndex = this._listItemElements().index(selectedListItem);\n\n    var differenceOfHeights = (getHeight(selectedListItem) - getHeight(this.element())) / 2;\n    var lookupOffset = $(this._list.element()).offset().top;\n    var dropDownHeightOption = this.option(\"dropDownOptions.height\");\n    var popupHeight = \"function\" === typeof dropDownHeightOption ? dropDownHeightOption() : dropDownHeightOption;\n    var windowHeight = getHeight(window);\n    var offsetTop = 0;\n\n    if (-1 !== selectedIndex) {\n      if (this._isCenteringEnabled(selectedIndex, listItemsCount)) {\n        this._scrollToSelectedItem();\n\n        var scrollOffsetTop = (popupHeight - getHeight(selectedListItem)) / 2 - this._getDifferenceOffsets(selectedListItem);\n\n        this._list.scrollTo(this._list.scrollTop() + MATERIAL_LOOKUP_LIST_PADDING / 2 - scrollOffsetTop);\n\n        offsetTop = differenceOfHeights + this._getDifferenceOffsets(selectedListItem);\n\n        if (lookupOffset < offsetTop && selectedIndex !== listItemsCount - 3) {\n          this._list.scrollTo(this._list.scrollTop() + this._getDifferenceOffsets(selectedListItem) / 2);\n\n          offsetTop = differenceOfHeights + this._getDifferenceOffsets(selectedListItem);\n        }\n      } else if (selectedIndex <= 1) {\n        this._list.scrollTo(0);\n\n        offsetTop = differenceOfHeights + this._getDifferenceOffsets(selectedListItem);\n      } else if (selectedIndex >= listItemsCount - 2) {\n        this._scrollToSelectedItem();\n\n        offsetTop = differenceOfHeights + this._getDifferenceOffsets(selectedListItem);\n      }\n\n      if (lookupOffset < offsetTop) {\n        this._scrollToSelectedItem();\n\n        offsetTop = differenceOfHeights + MATERIAL_LOOKUP_LIST_PADDING;\n      }\n    }\n\n    var offsetBottom = popupHeight - offsetTop - getHeight(this.element());\n\n    if (windowHeight - lookupOffset < offsetBottom) {\n      this._list.scrollTo(this._list.scrollTop() + differenceOfHeights - offsetBottom);\n\n      offsetTop = popupHeight - getHeight(this.element()) - MATERIAL_LOOKUP_LIST_PADDING;\n    }\n\n    return offsetTop;\n  },\n  _setPopupPosition: function () {\n    if (!this.option(\"dropDownCentered\")) {\n      return;\n    }\n\n    var flipped = this._popup.$wrapper().hasClass(LOOKUP_POPOVER_FLIP_VERTICAL_CLASS);\n\n    if (flipped) {\n      return;\n    }\n\n    var popupContentParent = $(this._popup.$content()).parent();\n\n    var popupOffset = this._getPopupOffset();\n\n    var position = locate(popupContentParent);\n    move(popupContentParent, {\n      top: position.top - popupOffset\n    });\n  },\n  _listItemGroupedElements: function () {\n    var groups = this._list._itemContainer().children();\n\n    var items = [];\n    groups.each((_, group) => {\n      items.push($(group).find(\".\" + GROUP_LIST_HEADER_CLASS)[0]);\n      var groupedItems = $(group).find(\".\" + LIST_ITEM_CLASS);\n      groupedItems.each((_, item) => {\n        items.push(item);\n      });\n    });\n    return $(items);\n  },\n  _calculateListHeight: function (grouped) {\n    var listItems = grouped ? this._listItemGroupedElements() : this._listItemElements();\n    var selectedListItem = $(\".\" + LIST_ITEM_SELECTED_CLASS);\n    var selectedIndex = listItems.index(selectedListItem);\n    var listHeight = 0;\n    var requireListItems = [];\n\n    if (0 === listItems.length) {\n      listHeight += MATERIAL_LOOKUP_LIST_PADDING;\n    } else if (listItems.length < MATERIAL_LOOKUP_LIST_ITEMS_COUNT) {\n      listItems.each((_, item) => {\n        listHeight += getOuterHeight(item);\n      });\n    } else {\n      if (selectedIndex <= 1) {\n        requireListItems = listItems.slice(0, MATERIAL_LOOKUP_LIST_ITEMS_COUNT);\n      } else if (this._isCenteringEnabled(selectedIndex, listItems.length)) {\n        requireListItems = listItems.slice(selectedIndex - 2, selectedIndex + 3);\n      } else {\n        requireListItems = listItems.slice(listItems.length - MATERIAL_LOOKUP_LIST_ITEMS_COUNT, listItems.length);\n      }\n\n      requireListItems.each((_, item) => {\n        listHeight += getOuterHeight(item);\n      });\n    }\n\n    return listHeight + (grouped ? MATERIAL_LOOKUP_LIST_PADDING : 2 * MATERIAL_LOOKUP_LIST_PADDING);\n  },\n  _getPopupHeight: function () {\n    if (this._list && this._list.itemElements()) {\n      return this._calculateListHeight(this.option(\"grouped\")) + (this._$searchWrapper ? getOuterHeight(this._$searchWrapper) : 0) + (this._popup._$bottom ? getOuterHeight(this._popup._$bottom) : 0) + (this._popup._$title ? getOuterHeight(this._popup._$title) : 0);\n    } else {\n      return \"auto\";\n    }\n  },\n  _renderPopup: function () {\n    if (this.option(\"usePopover\") && !this.option(\"dropDownOptions.fullScreen\")) {\n      if (this.option(\"_scrollToSelectedItemEnabled\")) {\n        this.callBase();\n      } else {\n        this._renderPopover();\n      }\n    } else {\n      this.callBase();\n    }\n\n    this._$popup.addClass(LOOKUP_POPUP_CLASS);\n\n    this._popup.$wrapper().addClass(LOOKUP_POPUP_WRAPPER_CLASS);\n  },\n  _renderPopover: function () {\n    this._popup = this._createComponent(this._$popup, Popover, extend(this._popupConfig(), this._options.cache(\"dropDownOptions\"), {\n      showEvent: null,\n      hideEvent: null,\n      target: this.$element(),\n      fullScreen: false,\n      shading: false,\n      hideOnParentScroll: true,\n      _fixWrapperPosition: false,\n      width: this._isInitialOptionValue(\"dropDownOptions.width\") ? function () {\n        return getOuterWidth(this.$element());\n      }.bind(this) : this._popupConfig().width\n    }));\n\n    this._popup.on({\n      showing: this._popupShowingHandler.bind(this),\n      shown: this._popupShownHandler.bind(this),\n      hiding: this._popupHidingHandler.bind(this),\n      hidden: this._popupHiddenHandler.bind(this),\n      contentReady: this._contentReadyHandler.bind(this)\n    });\n\n    if (this.option(\"_scrollToSelectedItemEnabled\")) {\n      this._popup._$arrow.remove();\n    }\n\n    this._setPopupContentId(this._popup.$content());\n\n    this._contentReadyHandler();\n  },\n  _popupHidingHandler: function () {\n    this.callBase();\n    this.option(\"focusStateEnabled\") && this.focus();\n  },\n  _popupHiddenHandler: function () {\n    this.callBase();\n\n    if (this.option(\"_scrollToSelectedItemEnabled\")) {\n      resetPosition($(this._popup.content()).parent());\n    }\n  },\n  _preventFocusOnPopup: noop,\n  _popupConfig: function () {\n    var result = extend(this.callBase(), {\n      toolbarItems: this._getPopupToolbarItems(),\n      hideOnParentScroll: false,\n      onPositioned: null,\n      maxHeight: \"100vh\",\n      showTitle: this.option(\"dropDownOptions.showTitle\"),\n      title: this.option(\"dropDownOptions.title\"),\n      titleTemplate: this._getTemplateByOption(\"dropDownOptions.titleTemplate\"),\n      onTitleRendered: this.option(\"dropDownOptions.onTitleRendered\"),\n      fullScreen: this.option(\"dropDownOptions.fullScreen\"),\n      shading: this.option(\"dropDownOptions.shading\"),\n      closeOnOutsideClick: this.option(\"dropDownOptions.closeOnOutsideClick\")\n    });\n    delete result.animation;\n    delete result.position;\n\n    if (this.option(\"_scrollToSelectedItemEnabled\")) {\n      result.position = this.option(\"dropDownCentered\") ? {\n        my: \"left top\",\n        at: \"left top\",\n        of: this.element()\n      } : {\n        my: \"left top\",\n        at: \"left bottom\",\n        of: this.element()\n      };\n      result.hideOnParentScroll = true;\n    }\n\n    each([\"position\", \"animation\", \"width\", \"height\"], (_, optionName) => {\n      var popupOptionValue = this.option(\"dropDownOptions.\".concat(optionName));\n\n      if (void 0 !== popupOptionValue) {\n        result[optionName] = popupOptionValue;\n      }\n    });\n    return result;\n  },\n  _getPopupToolbarItems: function () {\n    var buttonsConfig = \"useButtons\" === this.option(\"applyValueMode\") ? this._popupToolbarItemsConfig() : [];\n\n    var cancelButton = this._getCancelButtonConfig();\n\n    if (cancelButton) {\n      buttonsConfig.push(cancelButton);\n    }\n\n    var clearButton = this._getClearButtonConfig();\n\n    if (clearButton) {\n      buttonsConfig.push(clearButton);\n    }\n\n    return this._applyButtonsLocation(buttonsConfig);\n  },\n  _popupToolbarItemsConfig: function () {\n    return [{\n      shortcut: \"done\",\n      options: {\n        onClick: this._applyButtonHandler.bind(this),\n        text: this.option(\"applyButtonText\")\n      }\n    }];\n  },\n  _getCancelButtonConfig: function () {\n    return this.option(\"showCancelButton\") ? {\n      shortcut: \"cancel\",\n      onClick: this._cancelButtonHandler.bind(this),\n      options: {\n        onInitialized: e => {\n          e.component.registerKeyHandler(\"escape\", this.close.bind(this));\n        },\n        text: this.option(\"cancelButtonText\")\n      }\n    } : null;\n  },\n  _getClearButtonConfig: function () {\n    return this.option(\"showClearButton\") ? {\n      shortcut: \"clear\",\n      onClick: this._resetValue.bind(this),\n      options: {\n        text: this.option(\"clearButtonText\")\n      }\n    } : null;\n  },\n  _applyButtonHandler: function (args) {\n    if (args) {\n      this._saveValueChangeEvent(args.event);\n    }\n\n    this.option(\"value\", this._valueGetter(this._currentSelectedItem()));\n    this.callBase();\n  },\n  _cancelButtonHandler: function () {\n    this._refreshSelected();\n\n    this.callBase();\n  },\n  _refreshPopupVisibility: function () {\n    if (this.option(\"opened\")) {\n      this._updatePopupDimensions();\n    }\n  },\n  _dimensionChanged: function () {\n    if (this.option(\"usePopover\") && !this.option(\"dropDownOptions.width\")) {\n      this.option(\"dropDownOptions.width\", getWidth(this.$element()));\n    }\n\n    this._popup && this._updatePopupDimensions();\n  },\n  _input: function () {\n    return this._$searchBox || this.callBase();\n  },\n  _renderPopupContent: function () {\n    this.callBase();\n\n    this._renderSearch();\n  },\n  _renderSearch: function () {\n    var isSearchEnabled = this.option(\"searchEnabled\");\n\n    this._toggleSearchClass(isSearchEnabled);\n\n    if (isSearchEnabled) {\n      var $searchWrapper = this._$searchWrapper = $(\"<div>\").addClass(LOOKUP_SEARCH_WRAPPER_CLASS);\n      var $searchBox = this._$searchBox = $(\"<div>\").addClass(LOOKUP_SEARCH_CLASS).appendTo($searchWrapper);\n      var currentDevice = devices.current();\n      var searchMode = currentDevice.android && currentDevice.version[0] >= 5 ? \"text\" : \"search\";\n      var isKeyboardListeningEnabled = false;\n      this._searchBox = this._createComponent($searchBox, TextBox, {\n        onDisposing: () => isKeyboardListeningEnabled = false,\n        onFocusIn: () => isKeyboardListeningEnabled = true,\n        onFocusOut: () => isKeyboardListeningEnabled = false,\n        onKeyboardHandled: opts => isKeyboardListeningEnabled && this._list._keyboardHandler(opts),\n        mode: searchMode,\n        showClearButton: true,\n        valueChangeEvent: this.option(\"valueChangeEvent\"),\n        onValueChanged: e => {\n          this._searchHandler(e);\n        }\n      });\n\n      this._registerSearchKeyHandlers();\n\n      $searchWrapper.insertBefore(this._$list);\n\n      this._setSearchPlaceholder();\n    }\n  },\n  _removeSearch: function () {\n    this._$searchWrapper && this._$searchWrapper.remove();\n    delete this._$searchWrapper;\n    this._$searchBox && this._$searchBox.remove();\n    delete this._$searchBox;\n    delete this._searchBox;\n  },\n  _selectListItemHandler: function (e) {\n    var $itemElement = $(this._list.option(\"focusedElement\"));\n\n    if (!$itemElement.length) {\n      return;\n    }\n\n    e.preventDefault();\n    e.target = $itemElement.get(0);\n\n    this._saveValueChangeEvent(e);\n\n    this._selectListItem(e.itemData, $itemElement);\n  },\n  _registerSearchKeyHandlers: function () {\n    this._searchBox.registerKeyHandler(\"escape\", this.close.bind(this));\n\n    this._searchBox.registerKeyHandler(\"enter\", this._selectListItemHandler.bind(this));\n\n    this._searchBox.registerKeyHandler(\"space\", this._selectListItemHandler.bind(this));\n\n    this._searchBox.registerKeyHandler(\"end\", noop);\n\n    this._searchBox.registerKeyHandler(\"home\", noop);\n  },\n  _toggleSearchClass: function (isSearchEnabled) {\n    if (this._popup) {\n      this._popup.$wrapper().toggleClass(LOOKUP_POPUP_SEARCH_CLASS, isSearchEnabled);\n    }\n  },\n  _setSearchPlaceholder: function () {\n    if (!this._$searchBox) {\n      return;\n    }\n\n    var minSearchLength = this.option(\"minSearchLength\");\n    var placeholder = this.option(\"searchPlaceholder\");\n\n    if (minSearchLength && placeholder === messageLocalization.format(\"Search\")) {\n      placeholder = messageLocalization.getFormatter(\"dxLookup-searchPlaceholder\")(minSearchLength);\n    }\n\n    this._searchBox.option(\"placeholder\", placeholder);\n  },\n  _setAriaTargetForList: noop,\n  _renderList: function () {\n    this.callBase();\n\n    this._list.registerKeyHandler(\"escape\", () => {\n      this.close();\n    });\n  },\n  _listConfig: function () {\n    return extend(this.callBase(), {\n      tabIndex: 0,\n      grouped: this.option(\"grouped\"),\n      groupTemplate: this._getTemplateByOption(\"groupTemplate\"),\n      pullRefreshEnabled: this.option(\"pullRefreshEnabled\"),\n      useNativeScrolling: this.option(\"useNativeScrolling\"),\n      pullingDownText: this.option(\"pullingDownText\"),\n      pulledDownText: this.option(\"pulledDownText\"),\n      refreshingText: this.option(\"refreshingText\"),\n      pageLoadingText: this.option(\"pageLoadingText\"),\n      onScroll: this._scrollHandler.bind(this),\n      onPullRefresh: this._pullRefreshHandler.bind(this),\n      onPageLoading: this._pageLoadingHandler.bind(this),\n      pageLoadMode: this.option(\"pageLoadMode\"),\n      nextButtonText: this.option(\"nextButtonText\"),\n      indicateLoading: this.option(\"searchEnabled\"),\n      onSelectionChanged: this._getSelectionChangedHandler()\n    });\n  },\n  _getSelectionChangedHandler: function () {\n    return this.option(\"showSelectionControls\") ? this._selectionChangeHandler.bind(this) : noop;\n  },\n  _listContentReadyHandler: function () {\n    this.callBase(...arguments);\n\n    this._refreshSelected();\n  },\n  _runWithoutCloseOnScroll: function (callback) {\n    var {\n      _scrollToSelectedItemEnabled: _scrollToSelectedItemEnabled\n    } = this.option();\n\n    var hideOnParentScroll = this._popup.option(\"hideOnParentScroll\");\n\n    if (!_scrollToSelectedItemEnabled) {\n      callback();\n    } else {\n      this._popup.option(\"hideOnParentScroll\", false);\n\n      callback();\n      this._hideOnParentScrollTimer = setTimeout(() => {\n        this._popup.option(\"hideOnParentScroll\", hideOnParentScroll);\n      });\n    }\n  },\n  _setFocusPolicy: function () {\n    if (!this.option(\"focusStateEnabled\")) {\n      return;\n    }\n\n    this._runWithoutCloseOnScroll(() => {\n      if (this.option(\"searchEnabled\")) {\n        this._searchBox.focus();\n      } else {\n        eventsEngine.trigger(this._$list, \"focus\");\n      }\n    });\n  },\n  _focusTarget: function () {\n    return this._$field;\n  },\n  _keyboardEventBindingTarget: function () {\n    return this._$field;\n  },\n  _listItemClickHandler: function (e) {\n    this._saveValueChangeEvent(e.event);\n\n    this._selectListItem(e.itemData, e.event.currentTarget);\n  },\n  _selectListItem: function (itemData, target) {\n    this._list.selectItem(target);\n\n    if (\"instantly\" === this.option(\"applyValueMode\")) {\n      this._applyButtonHandler();\n    }\n  },\n  _currentSelectedItem: function () {\n    return this.option(\"grouped\") ? this._list.option(\"selectedItems[0]\").items[0] : this._list.option(\"selectedItems[0]\");\n  },\n  _resetValue: function (e) {\n    this._saveValueChangeEvent(e.event);\n\n    this.option(\"value\", null);\n    this.option(\"opened\", false);\n  },\n  _searchValue: function () {\n    return this.option(\"searchEnabled\") && this._searchBox ? this._searchBox.option(\"value\") : \"\";\n  },\n  _renderInputValue: function () {\n    return this.callBase().always(() => {\n      this._refreshSelected();\n    });\n  },\n  _renderPlaceholder: function () {\n    if (0 === this.$element().find(\".\" + TEXTEDITOR_INPUT_CLASS).length) {\n      return;\n    }\n\n    this.callBase();\n  },\n  _clean: function () {\n    this._$fieldWrapper.remove();\n\n    clearTimeout(this._hideOnParentScrollTimer);\n    this._hideOnParentScrollTimer = null;\n    this._$searchBox = null;\n    this.callBase();\n  },\n  _optionChanged: function (args) {\n    var {\n      name: name,\n      fullName: fullName,\n      value: value\n    } = args;\n\n    switch (name) {\n      case \"dataSource\":\n        this.callBase(...arguments);\n\n        this._renderField();\n\n        break;\n\n      case \"searchEnabled\":\n        if (this._popup) {\n          this._removeSearch();\n\n          this._renderSearch();\n        }\n\n        break;\n\n      case \"searchPlaceholder\":\n        this._setSearchPlaceholder();\n\n        break;\n\n      case \"minSearchLength\":\n        this._setSearchPlaceholder();\n\n        this.callBase(...arguments);\n        break;\n\n      case \"usePopover\":\n      case \"placeholder\":\n        this._invalidate();\n\n        break;\n\n      case \"clearButtonText\":\n      case \"showClearButton\":\n      case \"showCancelButton\":\n        this._setPopupOption(\"toolbarItems\", this._getPopupToolbarItems());\n\n        break;\n\n      case \"applyValueMode\":\n        this.callBase(...arguments);\n        break;\n\n      case \"onPageLoading\":\n        this._initPageLoadingAction();\n\n        break;\n\n      case \"onPullRefresh\":\n        this._initPullRefreshAction();\n\n        break;\n\n      case \"pullRefreshEnabled\":\n      case \"useNativeScrolling\":\n      case \"pullingDownText\":\n      case \"pulledDownText\":\n      case \"refreshingText\":\n      case \"pageLoadingText\":\n      case \"nextButtonText\":\n      case \"grouped\":\n      case \"groupTemplate\":\n        this._setListOption(name);\n\n        break;\n\n      case \"onScroll\":\n        this._initScrollAction();\n\n        break;\n\n      case \"pageLoadMode\":\n        this._setListOption(\"pageLoadMode\", this.option(\"pageLoadMode\"));\n\n        break;\n\n      case \"cleanSearchOnOpening\":\n      case \"_scrollToSelectedItemEnabled\":\n        break;\n\n      case \"dropDownOptions\":\n        switch (fullName) {\n          case \"dropDownOptions.width\":\n          case \"dropDownOptions.height\":\n            this._popupOptionChanged({\n              name: name,\n              fullName: fullName,\n              value: \"auto\" === value ? this.initialOption(\"dropDownOptions\")[getFieldName(fullName)] : value\n            });\n\n            this._options.cache(\"dropDownOptions\", this.option(\"dropDownOptions\"));\n\n            break;\n\n          default:\n            this.callBase(...arguments);\n        }\n\n        break;\n\n      case \"dropDownCentered\":\n        if (this.option(\"_scrollToSelectedItemEnabled\")) {\n          this.option(\"dropDownOptions.position\", void 0);\n\n          this._renderPopup();\n        }\n\n        break;\n\n      default:\n        this.callBase(...arguments);\n    }\n  },\n  focus: function () {\n    this.option(\"opened\") ? this._setFocusPolicy() : eventsEngine.trigger(this._focusTarget(), \"focus\");\n  },\n  field: function () {\n    return this._$field;\n  }\n});\nregisterComponent(\"dxLookup\", Lookup);\nexport default Lookup;","map":{"version":3,"sources":["/Users/fatmaamara/Desktop/projetetude/authentification-main/front-end/node_modules/devextreme/esm/ui/lookup.js"],"names":["getWidth","getHeight","getOuterHeight","getOuterWidth","$","eventsEngine","getWindow","window","nativeScrolling","noop","getPublicElement","each","extend","getFieldName","messageLocalization","devices","registerComponent","addNamespace","DropDownList","current","isMaterial","name","clickEventName","Popover","TextBox","ChildDefaultTemplate","locate","move","resetPosition","isDefined","getElementWidth","LOOKUP_CLASS","LOOKUP_SEARCH_CLASS","LOOKUP_SEARCH_WRAPPER_CLASS","LOOKUP_FIELD_CLASS","LOOKUP_ARROW_CLASS","LOOKUP_FIELD_WRAPPER_CLASS","LOOKUP_POPUP_CLASS","LOOKUP_POPUP_WRAPPER_CLASS","LOOKUP_POPUP_SEARCH_CLASS","LOOKUP_POPOVER_MODE","LOOKUP_EMPTY_CLASS","LOOKUP_POPOVER_FLIP_VERTICAL_CLASS","TEXTEDITOR_INPUT_CLASS","LIST_ITEM_CLASS","LIST_ITEM_SELECTED_CLASS","GROUP_LIST_HEADER_CLASS","MATERIAL_LOOKUP_LIST_ITEMS_COUNT","MATERIAL_LOOKUP_LIST_PADDING","Lookup","inherit","_supportedKeys","callBase","space","e","preventDefault","_validatedOpening","enter","_getDefaultOptions","placeholder","format","searchPlaceholder","searchEnabled","cleanSearchOnOpening","showCancelButton","showClearButton","clearButtonText","applyButtonText","pullRefreshEnabled","useNativeScrolling","pullingDownText","pulledDownText","refreshingText","pageLoadingText","onScroll","onPullRefresh","onPageLoading","pageLoadMode","nextButtonText","grouped","groupTemplate","usePopover","showDropDownButton","focusStateEnabled","dropDownOptions","showTitle","width","height","shading","closeOnOutsideClick","position","animation","title","titleTemplate","onTitleRendered","fullScreen","dropDownCentered","_scrollToSelectedItemEnabled","useHiddenSubmitElement","_defaultOptionsRules","themeName","concat","device","options","_device","isSimulator","real","deviceType","platform","phone","tablet","Math","min","_ignoreFunctionValueDeprecation","$element","_getPopupHeight","bind","_init","_initActions","_initScrollAction","_initPageLoadingAction","_initPullRefreshAction","_pageLoadingAction","_createActionByOption","_pullRefreshAction","_scrollAction","_scrollHandler","_pullRefreshHandler","_pageLoadingHandler","_initTemplates","_templateManager","addDefaultTemplates","group","_initMarkup","addClass","toggleClass","option","_inputWrapper","find","_dataSourceOptions","paginate","_fireContentReadyAction","_popupWrapperClass","_renderInput","fieldClickAction","_createAction","_toggleOpenState","_$field","on","NAME","event","$arrow","_$fieldWrapper","append","appendTo","_getInputContainer","_renderField","fieldTemplate","_getTemplateByOption","_renderFieldTemplate","displayValue","_updateField","String","_getLabelContainer","_renderDisplayText","text","_input","length","template","empty","data","_fieldRenderData","render","model","container","_popupShowingHandler","apply","arguments","_searchBox","_searchCanceled","_list","_popup","of","_popupShownHandler","scrollToSelectedItemEnabled","_setPopupPosition","_scrollToSelectedItem","selectedIndex","listItems","itemsCount","scrollToItem","item","items","_getDifferenceOffsets","selectedListItem","offset","top","element","_isCenteringEnabled","index","count","_getPopupOffset","listItemsCount","_listItemElements","differenceOfHeights","lookupOffset","dropDownHeightOption","popupHeight","windowHeight","offsetTop","scrollOffsetTop","scrollTo","scrollTop","offsetBottom","flipped","$wrapper","hasClass","popupContentParent","$content","parent","popupOffset","_listItemGroupedElements","groups","_itemContainer","children","_","push","groupedItems","_calculateListHeight","listHeight","requireListItems","slice","itemElements","_$searchWrapper","_$bottom","_$title","_renderPopup","_renderPopover","_$popup","_createComponent","_popupConfig","_options","cache","showEvent","hideEvent","target","hideOnParentScroll","_fixWrapperPosition","_isInitialOptionValue","showing","shown","hiding","_popupHidingHandler","hidden","_popupHiddenHandler","contentReady","_contentReadyHandler","_$arrow","remove","_setPopupContentId","focus","content","_preventFocusOnPopup","result","toolbarItems","_getPopupToolbarItems","onPositioned","maxHeight","my","at","optionName","popupOptionValue","buttonsConfig","_popupToolbarItemsConfig","cancelButton","_getCancelButtonConfig","clearButton","_getClearButtonConfig","_applyButtonsLocation","shortcut","onClick","_applyButtonHandler","_cancelButtonHandler","onInitialized","component","registerKeyHandler","close","_resetValue","args","_saveValueChangeEvent","_valueGetter","_currentSelectedItem","_refreshSelected","_refreshPopupVisibility","_updatePopupDimensions","_dimensionChanged","_$searchBox","_renderPopupContent","_renderSearch","isSearchEnabled","_toggleSearchClass","$searchWrapper","$searchBox","currentDevice","searchMode","android","version","isKeyboardListeningEnabled","onDisposing","onFocusIn","onFocusOut","onKeyboardHandled","opts","_keyboardHandler","mode","valueChangeEvent","onValueChanged","_searchHandler","_registerSearchKeyHandlers","insertBefore","_$list","_setSearchPlaceholder","_removeSearch","_selectListItemHandler","$itemElement","get","_selectListItem","itemData","minSearchLength","getFormatter","_setAriaTargetForList","_renderList","_listConfig","tabIndex","indicateLoading","onSelectionChanged","_getSelectionChangedHandler","_selectionChangeHandler","_listContentReadyHandler","_runWithoutCloseOnScroll","callback","_hideOnParentScrollTimer","setTimeout","_setFocusPolicy","trigger","_focusTarget","_keyboardEventBindingTarget","_listItemClickHandler","currentTarget","selectItem","_searchValue","_renderInputValue","always","_renderPlaceholder","_clean","clearTimeout","_optionChanged","fullName","value","_invalidate","_setPopupOption","_setListOption","_popupOptionChanged","initialOption","field"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (esm/ui/lookup.js)\r\n * Version: 21.2.4\r\n * Build date: Mon Dec 06 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\nimport {\r\n    getWidth,\r\n    getHeight,\r\n    getOuterHeight,\r\n    getOuterWidth\r\n} from \"../core/utils/size\";\r\nimport $ from \"../core/renderer\";\r\nimport eventsEngine from \"../events/core/events_engine\";\r\nimport {\r\n    getWindow\r\n} from \"../core/utils/window\";\r\nvar window = getWindow();\r\nimport {\r\n    nativeScrolling\r\n} from \"../core/utils/support\";\r\nimport {\r\n    noop\r\n} from \"../core/utils/common\";\r\nimport {\r\n    getPublicElement\r\n} from \"../core/element\";\r\nimport {\r\n    each\r\n} from \"../core/utils/iterator\";\r\nimport {\r\n    extend\r\n} from \"../core/utils/extend\";\r\nimport {\r\n    getFieldName\r\n} from \"../core/options/utils\";\r\nimport messageLocalization from \"../localization/message\";\r\nimport devices from \"../core/devices\";\r\nimport registerComponent from \"../core/component_registrator\";\r\nimport {\r\n    addNamespace\r\n} from \"../events/utils/index\";\r\nimport DropDownList from \"./drop_down_editor/ui.drop_down_list\";\r\nimport {\r\n    current,\r\n    isMaterial\r\n} from \"./themes\";\r\nimport {\r\n    name as clickEventName\r\n} from \"../events/click\";\r\nimport Popover from \"./popover\";\r\nimport TextBox from \"./text_box\";\r\nimport {\r\n    ChildDefaultTemplate\r\n} from \"../core/templates/child_default_template\";\r\nimport {\r\n    locate,\r\n    move,\r\n    resetPosition\r\n} from \"../animation/translator\";\r\nimport {\r\n    isDefined\r\n} from \"../core/utils/type\";\r\nimport {\r\n    getElementWidth\r\n} from \"./drop_down_editor/utils\";\r\nvar LOOKUP_CLASS = \"dx-lookup\";\r\nvar LOOKUP_SEARCH_CLASS = \"dx-lookup-search\";\r\nvar LOOKUP_SEARCH_WRAPPER_CLASS = \"dx-lookup-search-wrapper\";\r\nvar LOOKUP_FIELD_CLASS = \"dx-lookup-field\";\r\nvar LOOKUP_ARROW_CLASS = \"dx-lookup-arrow\";\r\nvar LOOKUP_FIELD_WRAPPER_CLASS = \"dx-lookup-field-wrapper\";\r\nvar LOOKUP_POPUP_CLASS = \"dx-lookup-popup\";\r\nvar LOOKUP_POPUP_WRAPPER_CLASS = \"dx-lookup-popup-wrapper\";\r\nvar LOOKUP_POPUP_SEARCH_CLASS = \"dx-lookup-popup-search\";\r\nvar LOOKUP_POPOVER_MODE = \"dx-lookup-popover-mode\";\r\nvar LOOKUP_EMPTY_CLASS = \"dx-lookup-empty\";\r\nvar LOOKUP_POPOVER_FLIP_VERTICAL_CLASS = \"dx-popover-flipped-vertical\";\r\nvar TEXTEDITOR_INPUT_CLASS = \"dx-texteditor-input\";\r\nvar LIST_ITEM_CLASS = \"dx-list-item\";\r\nvar LIST_ITEM_SELECTED_CLASS = \"dx-list-item-selected\";\r\nvar GROUP_LIST_HEADER_CLASS = \"dx-list-group-header\";\r\nvar MATERIAL_LOOKUP_LIST_ITEMS_COUNT = 5;\r\nvar MATERIAL_LOOKUP_LIST_PADDING = 8;\r\nvar Lookup = DropDownList.inherit({\r\n    _supportedKeys: function() {\r\n        return extend(this.callBase(), {\r\n            space: function(e) {\r\n                e.preventDefault();\r\n                this._validatedOpening()\r\n            },\r\n            enter: function() {\r\n                this._validatedOpening()\r\n            }\r\n        })\r\n    },\r\n    _getDefaultOptions: function() {\r\n        return extend(this.callBase(), {\r\n            placeholder: messageLocalization.format(\"Select\"),\r\n            searchPlaceholder: messageLocalization.format(\"Search\"),\r\n            searchEnabled: true,\r\n            cleanSearchOnOpening: true,\r\n            showCancelButton: true,\r\n            showClearButton: false,\r\n            clearButtonText: messageLocalization.format(\"Clear\"),\r\n            applyButtonText: messageLocalization.format(\"OK\"),\r\n            pullRefreshEnabled: false,\r\n            useNativeScrolling: true,\r\n            pullingDownText: messageLocalization.format(\"dxList-pullingDownText\"),\r\n            pulledDownText: messageLocalization.format(\"dxList-pulledDownText\"),\r\n            refreshingText: messageLocalization.format(\"dxList-refreshingText\"),\r\n            pageLoadingText: messageLocalization.format(\"dxList-pageLoadingText\"),\r\n            onScroll: null,\r\n            onPullRefresh: null,\r\n            onPageLoading: null,\r\n            pageLoadMode: \"scrollBottom\",\r\n            nextButtonText: messageLocalization.format(\"dxList-nextButtonText\"),\r\n            grouped: false,\r\n            groupTemplate: \"group\",\r\n            usePopover: false,\r\n            showDropDownButton: false,\r\n            focusStateEnabled: false,\r\n            dropDownOptions: {\r\n                showTitle: true,\r\n                width: function() {\r\n                    return .8 * getWidth(window)\r\n                },\r\n                height: function() {\r\n                    return .8 * getHeight(window)\r\n                },\r\n                shading: true,\r\n                closeOnOutsideClick: false,\r\n                position: void 0,\r\n                animation: {},\r\n                title: \"\",\r\n                titleTemplate: \"title\",\r\n                onTitleRendered: null,\r\n                fullScreen: false\r\n            },\r\n            dropDownCentered: false,\r\n            _scrollToSelectedItemEnabled: false,\r\n            useHiddenSubmitElement: true\r\n        })\r\n    },\r\n    _defaultOptionsRules: function() {\r\n        var themeName = current();\r\n        return this.callBase().concat([{\r\n            device: function() {\r\n                return !nativeScrolling\r\n            },\r\n            options: {\r\n                useNativeScrolling: false\r\n            }\r\n        }, {\r\n            device: function(_device) {\r\n                return !devices.isSimulator() && \"desktop\" === devices.real().deviceType && \"generic\" === _device.platform\r\n            },\r\n            options: {\r\n                usePopover: true,\r\n                dropDownOptions: {\r\n                    height: \"auto\"\r\n                }\r\n            }\r\n        }, {\r\n            device: {\r\n                platform: \"ios\",\r\n                phone: true\r\n            },\r\n            options: {\r\n                dropDownOptions: {\r\n                    fullScreen: true\r\n                }\r\n            }\r\n        }, {\r\n            device: {\r\n                platform: \"ios\",\r\n                tablet: true\r\n            },\r\n            options: {\r\n                dropDownOptions: {\r\n                    width: function() {\r\n                        return .4 * Math.min(getWidth(window), getHeight(window))\r\n                    },\r\n                    height: \"auto\"\r\n                },\r\n                usePopover: true\r\n            }\r\n        }, {\r\n            device: function() {\r\n                return \"desktop\" === devices.real().deviceType && !devices.isSimulator()\r\n            },\r\n            options: {\r\n                focusStateEnabled: true\r\n            }\r\n        }, {\r\n            device: function() {\r\n                return isMaterial(themeName)\r\n            },\r\n            options: {\r\n                usePopover: false,\r\n                searchEnabled: false,\r\n                showCancelButton: false,\r\n                dropDownCentered: true,\r\n                _scrollToSelectedItemEnabled: true,\r\n                dropDownOptions: {\r\n                    closeOnOutsideClick: true,\r\n                    _ignoreFunctionValueDeprecation: true,\r\n                    width: () => getElementWidth(this.$element()),\r\n                    height: function() {\r\n                        return this._getPopupHeight()\r\n                    }.bind(this),\r\n                    showTitle: false,\r\n                    shading: false\r\n                }\r\n            }\r\n        }])\r\n    },\r\n    _init: function() {\r\n        this.callBase();\r\n        this._initActions()\r\n    },\r\n    _initActions() {\r\n        this.callBase();\r\n        this._initScrollAction();\r\n        this._initPageLoadingAction();\r\n        this._initPullRefreshAction()\r\n    },\r\n    _initPageLoadingAction: function() {\r\n        this._pageLoadingAction = this._createActionByOption(\"onPageLoading\")\r\n    },\r\n    _initPullRefreshAction: function() {\r\n        this._pullRefreshAction = this._createActionByOption(\"onPullRefresh\")\r\n    },\r\n    _initScrollAction: function() {\r\n        this._scrollAction = this._createActionByOption(\"onScroll\")\r\n    },\r\n    _scrollHandler: function(e) {\r\n        this._scrollAction(e)\r\n    },\r\n    _pullRefreshHandler: function(e) {\r\n        this._pullRefreshAction(e)\r\n    },\r\n    _pageLoadingHandler: function(e) {\r\n        this._pageLoadingAction(e)\r\n    },\r\n    _initTemplates: function() {\r\n        this.callBase();\r\n        this._templateManager.addDefaultTemplates({\r\n            group: new ChildDefaultTemplate(\"group\"),\r\n            title: new ChildDefaultTemplate(\"title\")\r\n        })\r\n    },\r\n    _initMarkup: function() {\r\n        this.$element().addClass(LOOKUP_CLASS).toggleClass(LOOKUP_POPOVER_MODE, this.option(\"usePopover\"));\r\n        this.callBase()\r\n    },\r\n    _inputWrapper: function() {\r\n        return this.$element().find(\".\" + LOOKUP_FIELD_WRAPPER_CLASS)\r\n    },\r\n    _dataSourceOptions: function() {\r\n        return extend(this.callBase(), {\r\n            paginate: true\r\n        })\r\n    },\r\n    _fireContentReadyAction: noop,\r\n    _popupWrapperClass: function() {\r\n        return \"\"\r\n    },\r\n    _renderInput: function() {\r\n        var fieldClickAction = this._createAction(() => {\r\n            this._toggleOpenState()\r\n        });\r\n        this._$field = $(\"<div>\").addClass(LOOKUP_FIELD_CLASS);\r\n        eventsEngine.on(this._$field, addNamespace(clickEventName, this.NAME), e => {\r\n            fieldClickAction({\r\n                event: e\r\n            })\r\n        });\r\n        var $arrow = $(\"<div>\").addClass(LOOKUP_ARROW_CLASS);\r\n        this._$fieldWrapper = $(\"<div>\").addClass(LOOKUP_FIELD_WRAPPER_CLASS).append(this._$field).append($arrow).appendTo(this.$element())\r\n    },\r\n    _getInputContainer() {\r\n        return this._$fieldWrapper\r\n    },\r\n    _renderField: function() {\r\n        var fieldTemplate = this._getTemplateByOption(\"fieldTemplate\");\r\n        if (fieldTemplate && this.option(\"fieldTemplate\")) {\r\n            this._renderFieldTemplate(fieldTemplate);\r\n            return\r\n        }\r\n        var displayValue = this.option(\"displayValue\");\r\n        this._updateField(isDefined(displayValue) && String(displayValue) || this.option(\"placeholder\"));\r\n        this.$element().toggleClass(LOOKUP_EMPTY_CLASS, !this.option(\"selectedItem\"))\r\n    },\r\n    _getLabelContainer: function() {\r\n        return this._$field\r\n    },\r\n    _renderDisplayText: function(text) {\r\n        if (this._input().length) {\r\n            this.callBase(text)\r\n        } else {\r\n            this._updateField(text)\r\n        }\r\n    },\r\n    _updateField: function(text) {\r\n        this._$field.text(text)\r\n    },\r\n    _renderFieldTemplate: function(template) {\r\n        this._$field.empty();\r\n        var data = this._fieldRenderData();\r\n        template.render({\r\n            model: data,\r\n            container: getPublicElement(this._$field)\r\n        })\r\n    },\r\n    _fieldRenderData: function() {\r\n        return this.option(\"selectedItem\")\r\n    },\r\n    _popupShowingHandler: function() {\r\n        this.callBase.apply(this, arguments);\r\n        if (this.option(\"cleanSearchOnOpening\")) {\r\n            if (this.option(\"searchEnabled\") && this._searchBox.option(\"value\")) {\r\n                this._searchBox.option(\"value\", \"\");\r\n                this._searchCanceled()\r\n            }\r\n            this._list && this._list.option(\"focusedElement\", null)\r\n        }\r\n        if (this.option(\"dropDownOptions.fullScreen\") && this.option(\"_scrollToSelectedItemEnabled\")) {\r\n            this._popup.option(\"position\").of = $(window)\r\n        }\r\n    },\r\n    _popupShownHandler: function() {\r\n        var scrollToSelectedItemEnabled = this.option(\"_scrollToSelectedItemEnabled\");\r\n        var fullScreen = this.option(\"dropDownOptions.fullScreen\");\r\n        if (!fullScreen && scrollToSelectedItemEnabled) {\r\n            this._setPopupPosition()\r\n        }\r\n        this.callBase()\r\n    },\r\n    _scrollToSelectedItem: function() {\r\n        var selectedIndex = this._list.option(\"selectedIndex\");\r\n        var listItems = this._list.option(\"items\");\r\n        var itemsCount = listItems.length;\r\n        if (0 !== itemsCount) {\r\n            if (this._list.option(\"grouped\")) {\r\n                this._list.scrollToItem({\r\n                    group: itemsCount - 1,\r\n                    item: listItems[itemsCount - 1].items.length - 1\r\n                })\r\n            } else {\r\n                this._list.scrollToItem(itemsCount - 1)\r\n            }\r\n            this._list.scrollToItem(selectedIndex)\r\n        }\r\n    },\r\n    _getDifferenceOffsets: function(selectedListItem) {\r\n        return selectedListItem.offset().top - $(this.element()).offset().top\r\n    },\r\n    _isCenteringEnabled: (index, count) => 1 < index && index < count - 2,\r\n    _getPopupOffset: function() {\r\n        var listItemsCount = this._listItemElements().length;\r\n        if (0 === listItemsCount) {\r\n            return\r\n        }\r\n        var selectedListItem = $(this._list.element()).find(\".\" + LIST_ITEM_SELECTED_CLASS);\r\n        var selectedIndex = this._listItemElements().index(selectedListItem);\r\n        var differenceOfHeights = (getHeight(selectedListItem) - getHeight(this.element())) / 2;\r\n        var lookupOffset = $(this._list.element()).offset().top;\r\n        var dropDownHeightOption = this.option(\"dropDownOptions.height\");\r\n        var popupHeight = \"function\" === typeof dropDownHeightOption ? dropDownHeightOption() : dropDownHeightOption;\r\n        var windowHeight = getHeight(window);\r\n        var offsetTop = 0;\r\n        if (-1 !== selectedIndex) {\r\n            if (this._isCenteringEnabled(selectedIndex, listItemsCount)) {\r\n                this._scrollToSelectedItem();\r\n                var scrollOffsetTop = (popupHeight - getHeight(selectedListItem)) / 2 - this._getDifferenceOffsets(selectedListItem);\r\n                this._list.scrollTo(this._list.scrollTop() + MATERIAL_LOOKUP_LIST_PADDING / 2 - scrollOffsetTop);\r\n                offsetTop = differenceOfHeights + this._getDifferenceOffsets(selectedListItem);\r\n                if (lookupOffset < offsetTop && selectedIndex !== listItemsCount - 3) {\r\n                    this._list.scrollTo(this._list.scrollTop() + this._getDifferenceOffsets(selectedListItem) / 2);\r\n                    offsetTop = differenceOfHeights + this._getDifferenceOffsets(selectedListItem)\r\n                }\r\n            } else if (selectedIndex <= 1) {\r\n                this._list.scrollTo(0);\r\n                offsetTop = differenceOfHeights + this._getDifferenceOffsets(selectedListItem)\r\n            } else if (selectedIndex >= listItemsCount - 2) {\r\n                this._scrollToSelectedItem();\r\n                offsetTop = differenceOfHeights + this._getDifferenceOffsets(selectedListItem)\r\n            }\r\n            if (lookupOffset < offsetTop) {\r\n                this._scrollToSelectedItem();\r\n                offsetTop = differenceOfHeights + MATERIAL_LOOKUP_LIST_PADDING\r\n            }\r\n        }\r\n        var offsetBottom = popupHeight - offsetTop - getHeight(this.element());\r\n        if (windowHeight - lookupOffset < offsetBottom) {\r\n            this._list.scrollTo(this._list.scrollTop() + differenceOfHeights - offsetBottom);\r\n            offsetTop = popupHeight - getHeight(this.element()) - MATERIAL_LOOKUP_LIST_PADDING\r\n        }\r\n        return offsetTop\r\n    },\r\n    _setPopupPosition: function() {\r\n        if (!this.option(\"dropDownCentered\")) {\r\n            return\r\n        }\r\n        var flipped = this._popup.$wrapper().hasClass(LOOKUP_POPOVER_FLIP_VERTICAL_CLASS);\r\n        if (flipped) {\r\n            return\r\n        }\r\n        var popupContentParent = $(this._popup.$content()).parent();\r\n        var popupOffset = this._getPopupOffset();\r\n        var position = locate(popupContentParent);\r\n        move(popupContentParent, {\r\n            top: position.top - popupOffset\r\n        })\r\n    },\r\n    _listItemGroupedElements: function() {\r\n        var groups = this._list._itemContainer().children();\r\n        var items = [];\r\n        groups.each((_, group) => {\r\n            items.push($(group).find(\".\" + GROUP_LIST_HEADER_CLASS)[0]);\r\n            var groupedItems = $(group).find(\".\" + LIST_ITEM_CLASS);\r\n            groupedItems.each((_, item) => {\r\n                items.push(item)\r\n            })\r\n        });\r\n        return $(items)\r\n    },\r\n    _calculateListHeight: function(grouped) {\r\n        var listItems = grouped ? this._listItemGroupedElements() : this._listItemElements();\r\n        var selectedListItem = $(\".\" + LIST_ITEM_SELECTED_CLASS);\r\n        var selectedIndex = listItems.index(selectedListItem);\r\n        var listHeight = 0;\r\n        var requireListItems = [];\r\n        if (0 === listItems.length) {\r\n            listHeight += MATERIAL_LOOKUP_LIST_PADDING\r\n        } else if (listItems.length < MATERIAL_LOOKUP_LIST_ITEMS_COUNT) {\r\n            listItems.each((_, item) => {\r\n                listHeight += getOuterHeight(item)\r\n            })\r\n        } else {\r\n            if (selectedIndex <= 1) {\r\n                requireListItems = listItems.slice(0, MATERIAL_LOOKUP_LIST_ITEMS_COUNT)\r\n            } else if (this._isCenteringEnabled(selectedIndex, listItems.length)) {\r\n                requireListItems = listItems.slice(selectedIndex - 2, selectedIndex + 3)\r\n            } else {\r\n                requireListItems = listItems.slice(listItems.length - MATERIAL_LOOKUP_LIST_ITEMS_COUNT, listItems.length)\r\n            }\r\n            requireListItems.each((_, item) => {\r\n                listHeight += getOuterHeight(item)\r\n            })\r\n        }\r\n        return listHeight + (grouped ? MATERIAL_LOOKUP_LIST_PADDING : 2 * MATERIAL_LOOKUP_LIST_PADDING)\r\n    },\r\n    _getPopupHeight: function() {\r\n        if (this._list && this._list.itemElements()) {\r\n            return this._calculateListHeight(this.option(\"grouped\")) + (this._$searchWrapper ? getOuterHeight(this._$searchWrapper) : 0) + (this._popup._$bottom ? getOuterHeight(this._popup._$bottom) : 0) + (this._popup._$title ? getOuterHeight(this._popup._$title) : 0)\r\n        } else {\r\n            return \"auto\"\r\n        }\r\n    },\r\n    _renderPopup: function() {\r\n        if (this.option(\"usePopover\") && !this.option(\"dropDownOptions.fullScreen\")) {\r\n            if (this.option(\"_scrollToSelectedItemEnabled\")) {\r\n                this.callBase()\r\n            } else {\r\n                this._renderPopover()\r\n            }\r\n        } else {\r\n            this.callBase()\r\n        }\r\n        this._$popup.addClass(LOOKUP_POPUP_CLASS);\r\n        this._popup.$wrapper().addClass(LOOKUP_POPUP_WRAPPER_CLASS)\r\n    },\r\n    _renderPopover: function() {\r\n        this._popup = this._createComponent(this._$popup, Popover, extend(this._popupConfig(), this._options.cache(\"dropDownOptions\"), {\r\n            showEvent: null,\r\n            hideEvent: null,\r\n            target: this.$element(),\r\n            fullScreen: false,\r\n            shading: false,\r\n            hideOnParentScroll: true,\r\n            _fixWrapperPosition: false,\r\n            width: this._isInitialOptionValue(\"dropDownOptions.width\") ? function() {\r\n                return getOuterWidth(this.$element())\r\n            }.bind(this) : this._popupConfig().width\r\n        }));\r\n        this._popup.on({\r\n            showing: this._popupShowingHandler.bind(this),\r\n            shown: this._popupShownHandler.bind(this),\r\n            hiding: this._popupHidingHandler.bind(this),\r\n            hidden: this._popupHiddenHandler.bind(this),\r\n            contentReady: this._contentReadyHandler.bind(this)\r\n        });\r\n        if (this.option(\"_scrollToSelectedItemEnabled\")) {\r\n            this._popup._$arrow.remove()\r\n        }\r\n        this._setPopupContentId(this._popup.$content());\r\n        this._contentReadyHandler()\r\n    },\r\n    _popupHidingHandler: function() {\r\n        this.callBase();\r\n        this.option(\"focusStateEnabled\") && this.focus()\r\n    },\r\n    _popupHiddenHandler: function() {\r\n        this.callBase();\r\n        if (this.option(\"_scrollToSelectedItemEnabled\")) {\r\n            resetPosition($(this._popup.content()).parent())\r\n        }\r\n    },\r\n    _preventFocusOnPopup: noop,\r\n    _popupConfig: function() {\r\n        var result = extend(this.callBase(), {\r\n            toolbarItems: this._getPopupToolbarItems(),\r\n            hideOnParentScroll: false,\r\n            onPositioned: null,\r\n            maxHeight: \"100vh\",\r\n            showTitle: this.option(\"dropDownOptions.showTitle\"),\r\n            title: this.option(\"dropDownOptions.title\"),\r\n            titleTemplate: this._getTemplateByOption(\"dropDownOptions.titleTemplate\"),\r\n            onTitleRendered: this.option(\"dropDownOptions.onTitleRendered\"),\r\n            fullScreen: this.option(\"dropDownOptions.fullScreen\"),\r\n            shading: this.option(\"dropDownOptions.shading\"),\r\n            closeOnOutsideClick: this.option(\"dropDownOptions.closeOnOutsideClick\")\r\n        });\r\n        delete result.animation;\r\n        delete result.position;\r\n        if (this.option(\"_scrollToSelectedItemEnabled\")) {\r\n            result.position = this.option(\"dropDownCentered\") ? {\r\n                my: \"left top\",\r\n                at: \"left top\",\r\n                of: this.element()\r\n            } : {\r\n                my: \"left top\",\r\n                at: \"left bottom\",\r\n                of: this.element()\r\n            };\r\n            result.hideOnParentScroll = true\r\n        }\r\n        each([\"position\", \"animation\", \"width\", \"height\"], (_, optionName) => {\r\n            var popupOptionValue = this.option(\"dropDownOptions.\".concat(optionName));\r\n            if (void 0 !== popupOptionValue) {\r\n                result[optionName] = popupOptionValue\r\n            }\r\n        });\r\n        return result\r\n    },\r\n    _getPopupToolbarItems: function() {\r\n        var buttonsConfig = \"useButtons\" === this.option(\"applyValueMode\") ? this._popupToolbarItemsConfig() : [];\r\n        var cancelButton = this._getCancelButtonConfig();\r\n        if (cancelButton) {\r\n            buttonsConfig.push(cancelButton)\r\n        }\r\n        var clearButton = this._getClearButtonConfig();\r\n        if (clearButton) {\r\n            buttonsConfig.push(clearButton)\r\n        }\r\n        return this._applyButtonsLocation(buttonsConfig)\r\n    },\r\n    _popupToolbarItemsConfig: function() {\r\n        return [{\r\n            shortcut: \"done\",\r\n            options: {\r\n                onClick: this._applyButtonHandler.bind(this),\r\n                text: this.option(\"applyButtonText\")\r\n            }\r\n        }]\r\n    },\r\n    _getCancelButtonConfig: function() {\r\n        return this.option(\"showCancelButton\") ? {\r\n            shortcut: \"cancel\",\r\n            onClick: this._cancelButtonHandler.bind(this),\r\n            options: {\r\n                onInitialized: e => {\r\n                    e.component.registerKeyHandler(\"escape\", this.close.bind(this))\r\n                },\r\n                text: this.option(\"cancelButtonText\")\r\n            }\r\n        } : null\r\n    },\r\n    _getClearButtonConfig: function() {\r\n        return this.option(\"showClearButton\") ? {\r\n            shortcut: \"clear\",\r\n            onClick: this._resetValue.bind(this),\r\n            options: {\r\n                text: this.option(\"clearButtonText\")\r\n            }\r\n        } : null\r\n    },\r\n    _applyButtonHandler: function(args) {\r\n        if (args) {\r\n            this._saveValueChangeEvent(args.event)\r\n        }\r\n        this.option(\"value\", this._valueGetter(this._currentSelectedItem()));\r\n        this.callBase()\r\n    },\r\n    _cancelButtonHandler: function() {\r\n        this._refreshSelected();\r\n        this.callBase()\r\n    },\r\n    _refreshPopupVisibility: function() {\r\n        if (this.option(\"opened\")) {\r\n            this._updatePopupDimensions()\r\n        }\r\n    },\r\n    _dimensionChanged: function() {\r\n        if (this.option(\"usePopover\") && !this.option(\"dropDownOptions.width\")) {\r\n            this.option(\"dropDownOptions.width\", getWidth(this.$element()))\r\n        }\r\n        this._popup && this._updatePopupDimensions()\r\n    },\r\n    _input: function() {\r\n        return this._$searchBox || this.callBase()\r\n    },\r\n    _renderPopupContent: function() {\r\n        this.callBase();\r\n        this._renderSearch()\r\n    },\r\n    _renderSearch: function() {\r\n        var isSearchEnabled = this.option(\"searchEnabled\");\r\n        this._toggleSearchClass(isSearchEnabled);\r\n        if (isSearchEnabled) {\r\n            var $searchWrapper = this._$searchWrapper = $(\"<div>\").addClass(LOOKUP_SEARCH_WRAPPER_CLASS);\r\n            var $searchBox = this._$searchBox = $(\"<div>\").addClass(LOOKUP_SEARCH_CLASS).appendTo($searchWrapper);\r\n            var currentDevice = devices.current();\r\n            var searchMode = currentDevice.android && currentDevice.version[0] >= 5 ? \"text\" : \"search\";\r\n            var isKeyboardListeningEnabled = false;\r\n            this._searchBox = this._createComponent($searchBox, TextBox, {\r\n                onDisposing: () => isKeyboardListeningEnabled = false,\r\n                onFocusIn: () => isKeyboardListeningEnabled = true,\r\n                onFocusOut: () => isKeyboardListeningEnabled = false,\r\n                onKeyboardHandled: opts => isKeyboardListeningEnabled && this._list._keyboardHandler(opts),\r\n                mode: searchMode,\r\n                showClearButton: true,\r\n                valueChangeEvent: this.option(\"valueChangeEvent\"),\r\n                onValueChanged: e => {\r\n                    this._searchHandler(e)\r\n                }\r\n            });\r\n            this._registerSearchKeyHandlers();\r\n            $searchWrapper.insertBefore(this._$list);\r\n            this._setSearchPlaceholder()\r\n        }\r\n    },\r\n    _removeSearch: function() {\r\n        this._$searchWrapper && this._$searchWrapper.remove();\r\n        delete this._$searchWrapper;\r\n        this._$searchBox && this._$searchBox.remove();\r\n        delete this._$searchBox;\r\n        delete this._searchBox\r\n    },\r\n    _selectListItemHandler: function(e) {\r\n        var $itemElement = $(this._list.option(\"focusedElement\"));\r\n        if (!$itemElement.length) {\r\n            return\r\n        }\r\n        e.preventDefault();\r\n        e.target = $itemElement.get(0);\r\n        this._saveValueChangeEvent(e);\r\n        this._selectListItem(e.itemData, $itemElement)\r\n    },\r\n    _registerSearchKeyHandlers: function() {\r\n        this._searchBox.registerKeyHandler(\"escape\", this.close.bind(this));\r\n        this._searchBox.registerKeyHandler(\"enter\", this._selectListItemHandler.bind(this));\r\n        this._searchBox.registerKeyHandler(\"space\", this._selectListItemHandler.bind(this));\r\n        this._searchBox.registerKeyHandler(\"end\", noop);\r\n        this._searchBox.registerKeyHandler(\"home\", noop)\r\n    },\r\n    _toggleSearchClass: function(isSearchEnabled) {\r\n        if (this._popup) {\r\n            this._popup.$wrapper().toggleClass(LOOKUP_POPUP_SEARCH_CLASS, isSearchEnabled)\r\n        }\r\n    },\r\n    _setSearchPlaceholder: function() {\r\n        if (!this._$searchBox) {\r\n            return\r\n        }\r\n        var minSearchLength = this.option(\"minSearchLength\");\r\n        var placeholder = this.option(\"searchPlaceholder\");\r\n        if (minSearchLength && placeholder === messageLocalization.format(\"Search\")) {\r\n            placeholder = messageLocalization.getFormatter(\"dxLookup-searchPlaceholder\")(minSearchLength)\r\n        }\r\n        this._searchBox.option(\"placeholder\", placeholder)\r\n    },\r\n    _setAriaTargetForList: noop,\r\n    _renderList: function() {\r\n        this.callBase();\r\n        this._list.registerKeyHandler(\"escape\", () => {\r\n            this.close()\r\n        })\r\n    },\r\n    _listConfig: function() {\r\n        return extend(this.callBase(), {\r\n            tabIndex: 0,\r\n            grouped: this.option(\"grouped\"),\r\n            groupTemplate: this._getTemplateByOption(\"groupTemplate\"),\r\n            pullRefreshEnabled: this.option(\"pullRefreshEnabled\"),\r\n            useNativeScrolling: this.option(\"useNativeScrolling\"),\r\n            pullingDownText: this.option(\"pullingDownText\"),\r\n            pulledDownText: this.option(\"pulledDownText\"),\r\n            refreshingText: this.option(\"refreshingText\"),\r\n            pageLoadingText: this.option(\"pageLoadingText\"),\r\n            onScroll: this._scrollHandler.bind(this),\r\n            onPullRefresh: this._pullRefreshHandler.bind(this),\r\n            onPageLoading: this._pageLoadingHandler.bind(this),\r\n            pageLoadMode: this.option(\"pageLoadMode\"),\r\n            nextButtonText: this.option(\"nextButtonText\"),\r\n            indicateLoading: this.option(\"searchEnabled\"),\r\n            onSelectionChanged: this._getSelectionChangedHandler()\r\n        })\r\n    },\r\n    _getSelectionChangedHandler: function() {\r\n        return this.option(\"showSelectionControls\") ? this._selectionChangeHandler.bind(this) : noop\r\n    },\r\n    _listContentReadyHandler: function() {\r\n        this.callBase(...arguments);\r\n        this._refreshSelected()\r\n    },\r\n    _runWithoutCloseOnScroll: function(callback) {\r\n        var {\r\n            _scrollToSelectedItemEnabled: _scrollToSelectedItemEnabled\r\n        } = this.option();\r\n        var hideOnParentScroll = this._popup.option(\"hideOnParentScroll\");\r\n        if (!_scrollToSelectedItemEnabled) {\r\n            callback()\r\n        } else {\r\n            this._popup.option(\"hideOnParentScroll\", false);\r\n            callback();\r\n            this._hideOnParentScrollTimer = setTimeout(() => {\r\n                this._popup.option(\"hideOnParentScroll\", hideOnParentScroll)\r\n            })\r\n        }\r\n    },\r\n    _setFocusPolicy: function() {\r\n        if (!this.option(\"focusStateEnabled\")) {\r\n            return\r\n        }\r\n        this._runWithoutCloseOnScroll(() => {\r\n            if (this.option(\"searchEnabled\")) {\r\n                this._searchBox.focus()\r\n            } else {\r\n                eventsEngine.trigger(this._$list, \"focus\")\r\n            }\r\n        })\r\n    },\r\n    _focusTarget: function() {\r\n        return this._$field\r\n    },\r\n    _keyboardEventBindingTarget: function() {\r\n        return this._$field\r\n    },\r\n    _listItemClickHandler: function(e) {\r\n        this._saveValueChangeEvent(e.event);\r\n        this._selectListItem(e.itemData, e.event.currentTarget)\r\n    },\r\n    _selectListItem: function(itemData, target) {\r\n        this._list.selectItem(target);\r\n        if (\"instantly\" === this.option(\"applyValueMode\")) {\r\n            this._applyButtonHandler()\r\n        }\r\n    },\r\n    _currentSelectedItem: function() {\r\n        return this.option(\"grouped\") ? this._list.option(\"selectedItems[0]\").items[0] : this._list.option(\"selectedItems[0]\")\r\n    },\r\n    _resetValue: function(e) {\r\n        this._saveValueChangeEvent(e.event);\r\n        this.option(\"value\", null);\r\n        this.option(\"opened\", false)\r\n    },\r\n    _searchValue: function() {\r\n        return this.option(\"searchEnabled\") && this._searchBox ? this._searchBox.option(\"value\") : \"\"\r\n    },\r\n    _renderInputValue: function() {\r\n        return this.callBase().always(() => {\r\n            this._refreshSelected()\r\n        })\r\n    },\r\n    _renderPlaceholder: function() {\r\n        if (0 === this.$element().find(\".\" + TEXTEDITOR_INPUT_CLASS).length) {\r\n            return\r\n        }\r\n        this.callBase()\r\n    },\r\n    _clean: function() {\r\n        this._$fieldWrapper.remove();\r\n        clearTimeout(this._hideOnParentScrollTimer);\r\n        this._hideOnParentScrollTimer = null;\r\n        this._$searchBox = null;\r\n        this.callBase()\r\n    },\r\n    _optionChanged: function(args) {\r\n        var {\r\n            name: name,\r\n            fullName: fullName,\r\n            value: value\r\n        } = args;\r\n        switch (name) {\r\n            case \"dataSource\":\r\n                this.callBase(...arguments);\r\n                this._renderField();\r\n                break;\r\n            case \"searchEnabled\":\r\n                if (this._popup) {\r\n                    this._removeSearch();\r\n                    this._renderSearch()\r\n                }\r\n                break;\r\n            case \"searchPlaceholder\":\r\n                this._setSearchPlaceholder();\r\n                break;\r\n            case \"minSearchLength\":\r\n                this._setSearchPlaceholder();\r\n                this.callBase(...arguments);\r\n                break;\r\n            case \"usePopover\":\r\n            case \"placeholder\":\r\n                this._invalidate();\r\n                break;\r\n            case \"clearButtonText\":\r\n            case \"showClearButton\":\r\n            case \"showCancelButton\":\r\n                this._setPopupOption(\"toolbarItems\", this._getPopupToolbarItems());\r\n                break;\r\n            case \"applyValueMode\":\r\n                this.callBase(...arguments);\r\n                break;\r\n            case \"onPageLoading\":\r\n                this._initPageLoadingAction();\r\n                break;\r\n            case \"onPullRefresh\":\r\n                this._initPullRefreshAction();\r\n                break;\r\n            case \"pullRefreshEnabled\":\r\n            case \"useNativeScrolling\":\r\n            case \"pullingDownText\":\r\n            case \"pulledDownText\":\r\n            case \"refreshingText\":\r\n            case \"pageLoadingText\":\r\n            case \"nextButtonText\":\r\n            case \"grouped\":\r\n            case \"groupTemplate\":\r\n                this._setListOption(name);\r\n                break;\r\n            case \"onScroll\":\r\n                this._initScrollAction();\r\n                break;\r\n            case \"pageLoadMode\":\r\n                this._setListOption(\"pageLoadMode\", this.option(\"pageLoadMode\"));\r\n                break;\r\n            case \"cleanSearchOnOpening\":\r\n            case \"_scrollToSelectedItemEnabled\":\r\n                break;\r\n            case \"dropDownOptions\":\r\n                switch (fullName) {\r\n                    case \"dropDownOptions.width\":\r\n                    case \"dropDownOptions.height\":\r\n                        this._popupOptionChanged({\r\n                            name: name,\r\n                            fullName: fullName,\r\n                            value: \"auto\" === value ? this.initialOption(\"dropDownOptions\")[getFieldName(fullName)] : value\r\n                        });\r\n                        this._options.cache(\"dropDownOptions\", this.option(\"dropDownOptions\"));\r\n                        break;\r\n                    default:\r\n                        this.callBase(...arguments)\r\n                }\r\n                break;\r\n            case \"dropDownCentered\":\r\n                if (this.option(\"_scrollToSelectedItemEnabled\")) {\r\n                    this.option(\"dropDownOptions.position\", void 0);\r\n                    this._renderPopup()\r\n                }\r\n                break;\r\n            default:\r\n                this.callBase(...arguments)\r\n        }\r\n    },\r\n    focus: function() {\r\n        this.option(\"opened\") ? this._setFocusPolicy() : eventsEngine.trigger(this._focusTarget(), \"focus\")\r\n    },\r\n    field: function() {\r\n        return this._$field\r\n    }\r\n});\r\nregisterComponent(\"dxLookup\", Lookup);\r\nexport default Lookup;\r\n"]},"metadata":{},"sourceType":"module"}