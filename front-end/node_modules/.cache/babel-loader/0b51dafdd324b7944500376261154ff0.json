{"ast":null,"code":"/**\r\n * DevExtreme (esm/ui/scheduler/appointments/viewModelGenerator.js)\r\n * Version: 21.2.4\r\n * Build date: Mon Dec 06 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport VerticalAppointmentsStrategy from \"./rendering_strategies/strategy_vertical\";\nimport WeekAppointmentRenderingStrategy from \"./rendering_strategies/strategy_week\";\nimport HorizontalAppointmentsStrategy from \"./rendering_strategies/strategy_horizontal\";\nimport HorizontalMonthLineAppointmentsStrategy from \"./rendering_strategies/strategy_horizontal_month_line\";\nimport HorizontalMonthAppointmentsStrategy from \"./rendering_strategies/strategy_horizontal_month\";\nimport AgendaAppointmentsStrategy from \"./rendering_strategies/strategy_agenda\";\nimport { getAppointmentKey } from \"../../../renovation/ui/scheduler/appointment/utils\";\nimport { getOverflowIndicatorColor } from \"../../../renovation/ui/scheduler/appointment/overflow_indicator/utils\";\nvar RENDERING_STRATEGIES = {\n  horizontal: HorizontalAppointmentsStrategy,\n  horizontalMonth: HorizontalMonthAppointmentsStrategy,\n  horizontalMonthLine: HorizontalMonthLineAppointmentsStrategy,\n  vertical: VerticalAppointmentsStrategy,\n  week: WeekAppointmentRenderingStrategy,\n  agenda: AgendaAppointmentsStrategy\n};\nexport class AppointmentViewModelGenerator {\n  initRenderingStrategy(options) {\n    var RenderingStrategy = RENDERING_STRATEGIES[options.appointmentRenderingStrategyName];\n    this.renderingStrategy = new RenderingStrategy(options);\n  }\n\n  generate(filteredItems, options) {\n    var {\n      isRenovatedAppointments: isRenovatedAppointments\n    } = options;\n    var appointments = filteredItems ? filteredItems.slice() : [];\n    this.initRenderingStrategy(options);\n    var renderingStrategy = this.getRenderingStrategy();\n    var positionMap = renderingStrategy.createTaskPositionMap(appointments);\n    var viewModel = this.postProcess(appointments, positionMap, isRenovatedAppointments);\n\n    if (isRenovatedAppointments) {\n      return this.makeRenovatedViewModels(viewModel);\n    }\n\n    return {\n      positionMap: positionMap,\n      viewModel: viewModel\n    };\n  }\n\n  postProcess(filteredItems, positionMap, isRenovatedAppointments) {\n    var renderingStrategy = this.getRenderingStrategy();\n    return filteredItems.map((data, index) => {\n      if (!renderingStrategy.keepAppointmentSettings()) {\n        delete data.settings;\n      }\n\n      var appointmentSettings = positionMap[index];\n      appointmentSettings.forEach(item => {\n        item.direction = \"vertical\" === renderingStrategy.getDirection() && !item.allDay ? \"vertical\" : \"horizontal\";\n      });\n      var item = {\n        itemData: data,\n        settings: appointmentSettings\n      };\n\n      if (!isRenovatedAppointments) {\n        item.needRepaint = true;\n        item.needRemove = false;\n      }\n\n      return item;\n    });\n  }\n\n  makeRenovatedViewModels(viewModel) {\n    var strategy = this.getRenderingStrategy();\n    var regularViewModels = [];\n    var allDayViewModels = [];\n    var compactOptions = [];\n    viewModel.forEach(_ref => {\n      var {\n        itemData: itemData,\n        settings: settings\n      } = _ref;\n      settings.forEach(options => {\n        var item = this.prepareViewModel(options, strategy, itemData);\n\n        if (options.isCompact) {\n          compactOptions.push({\n            compactViewModel: options.virtual,\n            appointmentViewModel: item\n          });\n        } else if (options.allDay) {\n          allDayViewModels.push(item);\n        } else {\n          regularViewModels.push(item);\n        }\n      });\n    });\n    var compactViewModels = this.prepareCompactViewModels(compactOptions);\n\n    var result = _extends({\n      allDay: allDayViewModels,\n      regular: regularViewModels\n    }, compactViewModels);\n\n    return result;\n  }\n\n  prepareViewModel(options, strategy, itemData) {\n    var geometry = strategy.getAppointmentGeometry(options);\n    var viewModel = {\n      key: getAppointmentKey(geometry),\n      appointment: itemData,\n      geometry: _extends({}, geometry, {\n        leftVirtualWidth: options.leftVirtualWidth,\n        topVirtualHeight: options.topVirtualHeight\n      }),\n      info: _extends({}, options.info, {\n        allDay: options.allDay,\n        direction: options.direction,\n        appointmentReduced: options.appointmentReduced\n      })\n    };\n    return viewModel;\n  }\n\n  getCompactViewModelFrame(compactViewModel) {\n    return {\n      isAllDay: !!compactViewModel.isAllDay,\n      isCompact: compactViewModel.isCompact,\n      geometry: {\n        left: compactViewModel.left,\n        top: compactViewModel.top,\n        width: compactViewModel.width,\n        height: compactViewModel.height\n      },\n      items: {\n        colors: [],\n        data: [],\n        settings: []\n      }\n    };\n  }\n\n  prepareCompactViewModels(compactOptions) {\n    var regularCompact = {};\n    var allDayCompact = {};\n    compactOptions.forEach(_ref2 => {\n      var {\n        compactViewModel: compactViewModel,\n        appointmentViewModel: appointmentViewModel\n      } = _ref2;\n      var {\n        index: index,\n        isAllDay: isAllDay\n      } = compactViewModel;\n      var viewModel = isAllDay ? allDayCompact : regularCompact;\n\n      if (!viewModel[index]) {\n        viewModel[index] = this.getCompactViewModelFrame(compactViewModel);\n      }\n\n      var {\n        settings: settings,\n        data: data,\n        colors: colors\n      } = viewModel[index].items;\n      settings.push(appointmentViewModel);\n      data.push(appointmentViewModel.appointment);\n      colors.push(appointmentViewModel.info.resourceColor);\n    });\n\n    var toArray = items => Object.keys(items).map(key => _extends({\n      key: key\n    }, items[key]));\n\n    var allDayViewModels = toArray(allDayCompact);\n    var regularViewModels = toArray(regularCompact);\n    [...allDayViewModels, ...regularViewModels].forEach(viewModel => {\n      var {\n        colors: colors\n      } = viewModel.items;\n      viewModel.color = getOverflowIndicatorColor(colors[0], colors);\n    });\n    return {\n      allDayCompact: allDayViewModels,\n      regularCompact: regularViewModels\n    };\n  }\n\n  getRenderingStrategy() {\n    return this.renderingStrategy;\n  }\n\n}","map":{"version":3,"sources":["/Users/fatmaamara/Desktop/projetetude/authentification-main/front-end/node_modules/devextreme/esm/ui/scheduler/appointments/viewModelGenerator.js"],"names":["_extends","VerticalAppointmentsStrategy","WeekAppointmentRenderingStrategy","HorizontalAppointmentsStrategy","HorizontalMonthLineAppointmentsStrategy","HorizontalMonthAppointmentsStrategy","AgendaAppointmentsStrategy","getAppointmentKey","getOverflowIndicatorColor","RENDERING_STRATEGIES","horizontal","horizontalMonth","horizontalMonthLine","vertical","week","agenda","AppointmentViewModelGenerator","initRenderingStrategy","options","RenderingStrategy","appointmentRenderingStrategyName","renderingStrategy","generate","filteredItems","isRenovatedAppointments","appointments","slice","getRenderingStrategy","positionMap","createTaskPositionMap","viewModel","postProcess","makeRenovatedViewModels","map","data","index","keepAppointmentSettings","settings","appointmentSettings","forEach","item","direction","getDirection","allDay","itemData","needRepaint","needRemove","strategy","regularViewModels","allDayViewModels","compactOptions","_ref","prepareViewModel","isCompact","push","compactViewModel","virtual","appointmentViewModel","compactViewModels","prepareCompactViewModels","result","regular","geometry","getAppointmentGeometry","key","appointment","leftVirtualWidth","topVirtualHeight","info","appointmentReduced","getCompactViewModelFrame","isAllDay","left","top","width","height","items","colors","regularCompact","allDayCompact","_ref2","resourceColor","toArray","Object","keys","color"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (esm/ui/scheduler/appointments/viewModelGenerator.js)\r\n * Version: 21.2.4\r\n * Build date: Mon Dec 06 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\r\nimport VerticalAppointmentsStrategy from \"./rendering_strategies/strategy_vertical\";\r\nimport WeekAppointmentRenderingStrategy from \"./rendering_strategies/strategy_week\";\r\nimport HorizontalAppointmentsStrategy from \"./rendering_strategies/strategy_horizontal\";\r\nimport HorizontalMonthLineAppointmentsStrategy from \"./rendering_strategies/strategy_horizontal_month_line\";\r\nimport HorizontalMonthAppointmentsStrategy from \"./rendering_strategies/strategy_horizontal_month\";\r\nimport AgendaAppointmentsStrategy from \"./rendering_strategies/strategy_agenda\";\r\nimport {\r\n    getAppointmentKey\r\n} from \"../../../renovation/ui/scheduler/appointment/utils\";\r\nimport {\r\n    getOverflowIndicatorColor\r\n} from \"../../../renovation/ui/scheduler/appointment/overflow_indicator/utils\";\r\nvar RENDERING_STRATEGIES = {\r\n    horizontal: HorizontalAppointmentsStrategy,\r\n    horizontalMonth: HorizontalMonthAppointmentsStrategy,\r\n    horizontalMonthLine: HorizontalMonthLineAppointmentsStrategy,\r\n    vertical: VerticalAppointmentsStrategy,\r\n    week: WeekAppointmentRenderingStrategy,\r\n    agenda: AgendaAppointmentsStrategy\r\n};\r\nexport class AppointmentViewModelGenerator {\r\n    initRenderingStrategy(options) {\r\n        var RenderingStrategy = RENDERING_STRATEGIES[options.appointmentRenderingStrategyName];\r\n        this.renderingStrategy = new RenderingStrategy(options)\r\n    }\r\n    generate(filteredItems, options) {\r\n        var {\r\n            isRenovatedAppointments: isRenovatedAppointments\r\n        } = options;\r\n        var appointments = filteredItems ? filteredItems.slice() : [];\r\n        this.initRenderingStrategy(options);\r\n        var renderingStrategy = this.getRenderingStrategy();\r\n        var positionMap = renderingStrategy.createTaskPositionMap(appointments);\r\n        var viewModel = this.postProcess(appointments, positionMap, isRenovatedAppointments);\r\n        if (isRenovatedAppointments) {\r\n            return this.makeRenovatedViewModels(viewModel)\r\n        }\r\n        return {\r\n            positionMap: positionMap,\r\n            viewModel: viewModel\r\n        }\r\n    }\r\n    postProcess(filteredItems, positionMap, isRenovatedAppointments) {\r\n        var renderingStrategy = this.getRenderingStrategy();\r\n        return filteredItems.map((data, index) => {\r\n            if (!renderingStrategy.keepAppointmentSettings()) {\r\n                delete data.settings\r\n            }\r\n            var appointmentSettings = positionMap[index];\r\n            appointmentSettings.forEach(item => {\r\n                item.direction = \"vertical\" === renderingStrategy.getDirection() && !item.allDay ? \"vertical\" : \"horizontal\"\r\n            });\r\n            var item = {\r\n                itemData: data,\r\n                settings: appointmentSettings\r\n            };\r\n            if (!isRenovatedAppointments) {\r\n                item.needRepaint = true;\r\n                item.needRemove = false\r\n            }\r\n            return item\r\n        })\r\n    }\r\n    makeRenovatedViewModels(viewModel) {\r\n        var strategy = this.getRenderingStrategy();\r\n        var regularViewModels = [];\r\n        var allDayViewModels = [];\r\n        var compactOptions = [];\r\n        viewModel.forEach(_ref => {\r\n            var {\r\n                itemData: itemData,\r\n                settings: settings\r\n            } = _ref;\r\n            settings.forEach(options => {\r\n                var item = this.prepareViewModel(options, strategy, itemData);\r\n                if (options.isCompact) {\r\n                    compactOptions.push({\r\n                        compactViewModel: options.virtual,\r\n                        appointmentViewModel: item\r\n                    })\r\n                } else if (options.allDay) {\r\n                    allDayViewModels.push(item)\r\n                } else {\r\n                    regularViewModels.push(item)\r\n                }\r\n            })\r\n        });\r\n        var compactViewModels = this.prepareCompactViewModels(compactOptions);\r\n        var result = _extends({\r\n            allDay: allDayViewModels,\r\n            regular: regularViewModels\r\n        }, compactViewModels);\r\n        return result\r\n    }\r\n    prepareViewModel(options, strategy, itemData) {\r\n        var geometry = strategy.getAppointmentGeometry(options);\r\n        var viewModel = {\r\n            key: getAppointmentKey(geometry),\r\n            appointment: itemData,\r\n            geometry: _extends({}, geometry, {\r\n                leftVirtualWidth: options.leftVirtualWidth,\r\n                topVirtualHeight: options.topVirtualHeight\r\n            }),\r\n            info: _extends({}, options.info, {\r\n                allDay: options.allDay,\r\n                direction: options.direction,\r\n                appointmentReduced: options.appointmentReduced\r\n            })\r\n        };\r\n        return viewModel\r\n    }\r\n    getCompactViewModelFrame(compactViewModel) {\r\n        return {\r\n            isAllDay: !!compactViewModel.isAllDay,\r\n            isCompact: compactViewModel.isCompact,\r\n            geometry: {\r\n                left: compactViewModel.left,\r\n                top: compactViewModel.top,\r\n                width: compactViewModel.width,\r\n                height: compactViewModel.height\r\n            },\r\n            items: {\r\n                colors: [],\r\n                data: [],\r\n                settings: []\r\n            }\r\n        }\r\n    }\r\n    prepareCompactViewModels(compactOptions) {\r\n        var regularCompact = {};\r\n        var allDayCompact = {};\r\n        compactOptions.forEach(_ref2 => {\r\n            var {\r\n                compactViewModel: compactViewModel,\r\n                appointmentViewModel: appointmentViewModel\r\n            } = _ref2;\r\n            var {\r\n                index: index,\r\n                isAllDay: isAllDay\r\n            } = compactViewModel;\r\n            var viewModel = isAllDay ? allDayCompact : regularCompact;\r\n            if (!viewModel[index]) {\r\n                viewModel[index] = this.getCompactViewModelFrame(compactViewModel)\r\n            }\r\n            var {\r\n                settings: settings,\r\n                data: data,\r\n                colors: colors\r\n            } = viewModel[index].items;\r\n            settings.push(appointmentViewModel);\r\n            data.push(appointmentViewModel.appointment);\r\n            colors.push(appointmentViewModel.info.resourceColor)\r\n        });\r\n        var toArray = items => Object.keys(items).map(key => _extends({\r\n            key: key\r\n        }, items[key]));\r\n        var allDayViewModels = toArray(allDayCompact);\r\n        var regularViewModels = toArray(regularCompact);\r\n        [...allDayViewModels, ...regularViewModels].forEach(viewModel => {\r\n            var {\r\n                colors: colors\r\n            } = viewModel.items;\r\n            viewModel.color = getOverflowIndicatorColor(colors[0], colors)\r\n        });\r\n        return {\r\n            allDayCompact: allDayViewModels,\r\n            regularCompact: regularViewModels\r\n        }\r\n    }\r\n    getRenderingStrategy() {\r\n        return this.renderingStrategy\r\n    }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}